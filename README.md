

# Satellite Quantum Key Distribution Security Curves

*Quantum keys don’t fail quietly—loss and noise can leave you with bits, but no secrecy. We model the cliff to surface silent breakage before it becomes a system risk.*

[![Python 3.10+](https://img.shields.io/badge/python-3.10+-blue.svg)](https://www.python.org/downloads/)
[![License: MIT](https://img.shields.io/badge/License-MIT-yellow.svg)](https://opensource.org/licenses/MIT)
[![Google Scholar](https://img.shields.io/badge/Google_Scholar-Profile-blue?logo=google-scholar)](https://scholar.google.com/citations?user=tvwpCcgAAAAJ)
[![Hugging Face](https://img.shields.io/badge/huggingface-Cohærence-white)](https://huggingface.co/Cohaerence)
[![X](https://img.shields.io/badge/X-@coherence-blue)](https://x.com/coherence)
[![Website](https://img.shields.io/badge/website-christopheraltman.com-green)](https://www.christopheraltman.com)
[![LinkedIn](https://img.shields.io/badge/LinkedIn-Altman-blue?logo=linkedin&logoColor=white)](https://www.linkedin.com/in/Altman)

<a id="featured-figure"></a>
<picture>
  <source media="(prefers-color-scheme: dark)" srcset="figures/hero_dark.jpg">
  <img alt="Secret key rate and QBER vs channel loss" src="figures/hero_light.jpg" width="920">
</picture>

*Featured result: secret-key rate and QBER vs channel loss (no-attack vs intercept–resend).*
Plots are generated by `./py -m sat_qkd_lab.run sweep` and written to `figures/`.

## Mathematical spine

Transmittance `η` is the probability a photon survives the channel and reaches the receiver.  
QBER `e` is the bit error rate after sifting, so it captures the net disturbance of the link.  
Binary entropy `h(e)` expresses uncertainty per bit (0 to 1), and it rises quickly with noise.  
For BB84, the asymptotic secret fraction decreases as `e` grows and vanishes as `e → 0.5`.  
That’s the security cliff: detections and sifted bits can remain nonzero while secrecy collapses.  

## Physical model intuition

Abort headroom is `qber_abort − qber_mean`, the distance to the protocol’s error threshold.  
CAR (coincidence‑to‑accidental ratio) is a signal‑quality witness in entanglement‑based QKD.  
Link loss in dB maps to transmittance via `loss_db = −10 log10(η)`.  
Satellite passes turn elevation into time‑varying loss and background noise.  
Finite‑key bounds cap what can be claimed with limited samples, even when averages look good.  

## Instrument primitives (timing + fading)

Timing jitter σ is the detector’s uncertainty in photon arrival time (time‑tag noise).  
Typical single‑photon detectors sit around 10–200 ps (ps = 10^-12 s).  
σ interacts with the coincidence window: too much jitter raises accidentals.  
The coincidence window τc is the tolerance used to match paired detections into coincidences.  
Typical τc is sub‑ns (ns = 10^-9 s), trading more coincidences for more accidentals.  
Fading variance Var(T) measures how the instantaneous transmittance T fluctuates.  
Free‑space optical channels often show heavy‑tailed fading where rare deep fades dominate.  
Modeling only mean loss is insufficient when Var(T) is large.  
These primitives will be wired into the time‑tag/coincidence engine, detector effects, and atmospheric fading options in later prompts.  

This lab acts as a link‑budget → security‑budget translator for engineering decisions.  

## Quickstart

```bash
git clone https://github.com/christopher-altman/sat-qkd-security-curves
cd sat-qkd-security-curves

# ensure repo-local runners are executable (if present)
[ -f ./py ] && chmod +x ./py
[ -f ./pytest ] && chmod +x ./pytest

# fail fast if runners are missing
test -x ./py || { echo "Missing ./py runner; see repo-local runners section." >&2; exit 1; }
test -x ./pytest || { echo "Missing ./pytest runner; see repo-local runners section." >&2; exit 1; }

PY=python3
$PY -V  # must be >= 3.10
test -x .venv/bin/python || $PY -m venv .venv

./py -m pip install -U pip
./py -m pip install -e ".[dev]"

./py -m sat_qkd_lab.run --help
./pytest -q
```

Quick run examples:

```bash
./py -m sat_qkd_lab.run sweep --loss-min 20 --loss-max 60 --steps 21 --pulses 200000
./py -m sat_qkd_lab.run pass-sweep --max-elevation 70 --pass-duration 300
./py -m sat_qkd_lab.run experiment-run --n-blocks 20 --block-seconds 30 --outdir .
./py -m sat_qkd_lab.run forecast-run --forecasts forecasts.json --outdir .
./py -m sat_qkd_lab.run coincidence-sim --loss-min 20 --loss-max 60 --steps 9 --outdir .
```

## Layout

```
.
├─ src/sat_qkd_lab/
│  ├─ run.py
│  ├─ plotting.py
│  ├─ attacks.py
│  ├─ eb_qkd.py
│  ├─ pass_model.py
│  ├─ experiment.py
│  ├─ forecast_harness.py
│  ├─ forecast.py
│  ├─ timetags.py
│  ├─ coincidence.py
│  ├─ calibration_fit.py
│  ├─ telemetry.py
│  ├─ clock_sync.py
│  ├─ background_process.py
│  ├─ polarization_drift.py
│  ├─ plotting.py
│  ├─ dashboard.py
│  └─ ...
├─ tests/
│  ├─ test_forecast_harness.py
│  ├─ test_calibration_fit.py
│  └─ ...
├─ figures/
├─ reports/
└─ docs/
```
Notes: `docs/` contains local prompt artifacts and may be gitignored for archival only.

## Problem

Satellite and fiber QKD systems live or die on a simple fact: bits can still flow while secrecy collapses. This repo models that security cliff and makes it visible before it becomes a system risk.

## Thesis

Security curves are only trustworthy if they respect instrument constraints. This lab ties link budgets, detector effects, and protocol thresholds into a single engineering picture.

## Physics/Math Background

Transmittance `η` is the probability a photon survives the channel and reaches the receiver.  
QBER `e` is the bit error rate after sifting, so it captures the net disturbance of the link.  
Binary entropy `h(e)` expresses uncertainty per bit (0 to 1), and it rises quickly with noise.  
For BB84, the asymptotic secret fraction decreases as `e` grows and vanishes as `e → 0.5`.  
That’s the security cliff: detections and sifted bits can remain nonzero while secrecy collapses.  

Abort headroom is `qber_abort − qber_mean`, the distance to the protocol’s error threshold.  
CAR (coincidence‑to‑accidental ratio) is a signal‑quality witness in entanglement‑based QKD.  
Link loss in dB maps to transmittance via `loss_db = −10 log10(η)`.  
Satellite passes turn elevation into time‑varying loss and background noise.  
Finite‑key bounds cap what can be claimed with limited samples, even when averages look good.  

Realism primitives (units explicit): timing jitter σ is typically 10–200 ps for SPDs and stored in seconds in code; coincidence window τc is sub‑ns and stored in seconds; fading variance Var(T) captures heavy‑tailed free‑space optics where rare deep fades dominate.  

## Approach

- Expected‑value BB84/EB‑QKD sweeps with finite‑key hooks.
- Time‑tag coincidence simulation with sync discipline and detector effects.
- Pass‑sweep models for elevation loss, pointing, fading, and background.
- Calibration fitting with identifiability checks and uncertainty propagation.
- Blinded experiment and forecast harnesses for protocol hygiene.

## Capabilities

- Blinded experiment runner: schedules blocks, stores blinded labels separately, and only reveals group analysis with `--unblind`.
- Forecast‑run: scores precommitted forecast files; unblind toggles label visibility in outputs.
- Calibration outputs: R², parameter uncertainty, FIM condition number, and an `identifiable` gate in reports.
- Dashboard: Streamlit control panel. Install with `./py -m pip install -e ".[dashboard]"` and launch via `./py -m sat_qkd_lab.dashboard`.
- Artifacts & provenance: each prompt writes `docs/report-P{N}-...` and `docs/diff-P{N}-...` with a verbatim `ls -l docs` gating proof.

## Why it matters

Operators need to see where secrecy collapses long before it fails in the field. This repo makes that cliff explicit and measurable.

## References

- Liao et al., Nature 549, 43 (2017) — satellite QKD field results.
- Bourgoin et al., NJP 15, 023006 (2013) — LEO QKD analysis framework.

## Contact

https://www.christopheraltman.com

Christopher Altman (2026)

Units are absolute QBER (e.g., headroom = 0.05 means 5% margin to the 11% abort threshold).

## Results

The model generates:

- `figures/key_qber_vs_loss.png` — QBER vs channel loss
- `figures/key_fraction_vs_loss.png` — Secret fraction vs channel loss (legacy alias: `key_key_fraction_vs_loss.png`)
- `figures/qber_vs_loss_ci.png` — QBER with 95% CI bands (when `--trials > 1`)
- `figures/secret_fraction_vs_loss_ci.png` — Secret fraction with 95% CI (legacy alias: `key_rate_vs_loss_ci.png`)
- `figures/qber_headroom_vs_loss.png` — Security headroom (QBER margin to abort) vs loss
- `figures/decoy_key_rate_vs_loss.png` — Decoy-state key rate vs loss
- `figures/decoy_key_rate_vs_loss_realism.png` — Decoy key rate vs loss with realism enabled
- `figures/finite_key_comparison.png` — Asymptotic vs finite-key rate (when `--finite-key`)
- `figures/finite_key_bits_vs_loss.png` — Extractable secret bits vs loss (when `--finite-key`)
- `figures/finite_size_penalty.png` — Finite-size penalty factor vs loss (when `--finite-key`)
- `figures/finite_key_rate_vs_n_sent.png` — Finite-key rate vs total pulses (when `--finite-key`)
- `figures/key_rate_vs_elevation.png` — Key rate vs elevation angle (when `pass-sweep`)
- `figures/secure_window_per_pass.png` — Secure window timing over pass (when `pass-sweep`)
- `figures/loss_vs_elevation.png` — Total link loss vs elevation (when `pass-sweep`)
- `reports/latest.json` — Raw sweep metrics with schema version and timestamp

**Figure 1. Estimated secret-key rate versus channel loss for BB84.** ([↑ featured figure](#featured-figure))  
A Monte-Carlo sweep shows that link loss alone reduces detections but does not destroy secrecy until error rates dominate. Under an intercept–resend attack, the secret-key fraction collapses to zero at moderate loss even while sifted bits remain non-zero, revealing the security cliff where privacy amplification can no longer extract secrecy.

**Figure 2. Quantum Bit Error Rate (QBER) versus channel loss for BB84.** ([↑ featured figure](#featured-figure))  
Without attack, intrinsic measurement noise keeps QBER low across loss. An intercept–resend adversary injects a strong QBER signature, driving errors beyond the tolerable entropy budget. The plotted spikes illustrate the detectable breakage regime that classical throughput monitors would miss without explicit QBER estimation.

### JSON Output Schema (v0.3)

The output JSON includes these fields for CI sweeps:

```json
{
  "schema_version": "0.4",
  "generated_utc": "2026-01-02T00:00:00Z",
  "loss_sweep_ci": {
    "no_attack": [{
      "qber_mean": 0.025,
      "qber_ci_low": 0.018,
      "qber_ci_high": 0.032,
      "secret_fraction_mean": 0.85,
      "secret_fraction_ci_low": 0.80,
      "secret_fraction_ci_high": 0.90,
      "key_rate_per_pulse_mean": 0.0012,
      "key_rate_per_pulse_ci_low": 0.0010,
      "key_rate_per_pulse_ci_high": 0.0014,
      "abort_rate": 0.0
    }]
  }
}
```

For finite-key sweeps (`--finite-key`), the JSON includes additional fields:

```json
{
  "schema_version": "0.4",
  "finite_key_sweep": {
    "no_attack": [{
      "loss_db": 25.0,
      "qber": 0.025,
      "qber_hat": 0.025,
      "qber_upper": 0.032,
      "ell_bits": 45000.0,
      "key_rate_per_pulse_asymptotic": 0.0012,
      "key_rate_per_pulse_finite": 0.0009,
      "finite_size_penalty": 0.25,
      "eps_total": 2.00001e-10,
      "f_ec": 1.16,
      "delta_eps_bits": 150.0
    }]
  },
  "parameters": {
    "finite_key": true,
    "eps_pe": 1e-10,
    "eps_sec": 1e-10,
    "eps_cor": 1e-15,
    "ec_efficiency": 1.16,
    "pe_frac": 0.5,
    "m_pe": null
  }
}
```

All CI lower bounds are clamped to 0; QBER CI upper is clamped to 0.5.


## Interpretation

The curves show an engineering-facing “security budget.” Loss reduces detections (sifted key), while noise and attacks raise QBER. Once QBER rises enough, the secret fraction collapses to zero: you can still exchange bits, but you cannot distill secrecy. This makes the QKD security story measurable and testable, rather than rhetorical.

## Why this matters

Physics-level behavior (loss/noise/attack) translates into operational metrics (QBER, secret-key rate), imperative metrics in the construction of integrated satellite + fibre QKD networks.

## Topics

`qml` · `quantum-ml` · `verification` · `cryptography` · `robustness` · `quantum-cryptography` · `qkd` · `bb84` · `satellite` · `security` · `noise-analysis` · `infosec` · `network-security` · `simulation`

## References

1. Bennett, C. H., & Brassard, G. (1984). [Quantum cryptography: Public key distribution and coin tossing.](https://www.sciencedirect.com/science/article/pii/S0304397514004241) *Proceedings of the IEEE International Conference on Computers, Systems and Signal Processing* (Bangalore, India), 175–179.

2. Ekert, A. K. (1991). [Quantum cryptography based on Bell’s theorem.](https://doi.org/10.1103/PhysRevLett.67.661) *Physical Review Letters*, *67*(6), 661–663. 

3. Shor, P. W., & Preskill, J. (2000). [Simple proof of security of the BB84 quantum key distribution protocol.](https://doi.org/10.1103/PhysRevLett.85.441) *Physical Review Letters*, *85*, 441–444. 

4. Renner, R., Gisin, N., & Kraus, B. (2005). [An information-theoretic security proof for QKD protocols.](http://arXiv:quant-ph/0502064) *[Physical Review A](https://doi.org/10.1103/PhysRevA.72.012332)*, *72*, 012332.  

5. Gisin, N., Ribordy, G., Tittel, W., & Zbinden, H. (2002). [Quantum cryptography.](https://doi.org/10.1103/RevModPhys.74.145) *Reviews of Modern Physics*, *74*(1), 145–195. 

6. Altman, C., Williams, C., Ursin, R., Villoresi, P., Sharma, V. [Astronaut Development and Deployment of a Secure Space Communications Network.](https://drive.google.com/file/d/0B99KWApna6GoX3JzZGMzbzNrMjg/view?resourcekey=0-b1lf7VUq8QmpRriVN5N2sw) NASA NIAC/OCT; DARPA QUINESS (Macroscopic Quantum Communications). 

## Citations

If you use QVL in your research, please cite:

```bibtex
@software{sat-qkd-curves2026,
  title={Satellite Quantum Key Distribution Security Curves},
  author={Altman, Christopher},
  year={2026},
  url={https://github.com/christopher-altman/sat-qkd-security-curves}
}
```

## License

MIT License. See [LICENSE](LICENSE) for details.

## Contact

- **Website:** [christopheraltman.com](https://christopheraltman.com)
- **Research portfolio:** [lab.christopheraltman.com](https://lab.christopheraltman.com/)
- **Portfolio mirror:** [christopher-altman.github.io](https://christopher-altman.github.io/)
- **GitHub:** [github.com/christopher-altman](https://github.com/christopher-altman)
- **Google Scholar:** [scholar.google.com/citations?user=tvwpCcgAAAAJ](https://scholar.google.com/citations?user=tvwpCcgAAAAJ)
- **Email:** x@christopheraltman.com

---

*Christopher Altman (2026)*
