

# Satellite Quantum Key Distribution Security Curves

*Quantum keys don’t fail quietly—loss and noise can leave you with bits, but no secrecy. We model the cliff to surface silent breakage before it becomes a system risk.*

[![Python 3.10+](https://img.shields.io/badge/python-3.10+-blue.svg)](https://www.python.org/downloads/)
[![License: MIT](https://img.shields.io/badge/License-MIT-yellow.svg)](https://opensource.org/licenses/MIT)
[![Google Scholar](https://img.shields.io/badge/Google_Scholar-Profile-blue?logo=google-scholar)](https://scholar.google.com/citations?user=tvwpCcgAAAAJ)
[![Hugging Face](https://img.shields.io/badge/huggingface-Cohærence-white)](https://huggingface.co/Cohaerence)
[![X](https://img.shields.io/badge/X-@coherence-blue)](https://x.com/coherence)
[![Website](https://img.shields.io/badge/website-christopheraltman.com-green)](https://www.christopheraltman.com)
[![LinkedIn](https://img.shields.io/badge/LinkedIn-Altman-blue?logo=linkedin&logoColor=white)](https://www.linkedin.com/in/Altman)

<a id="featured-figure"></a>
<picture>
  <source media="(prefers-color-scheme: dark)" srcset="figures/hero_dark.jpg">
  <img alt="Secret key rate and QBER vs channel loss" src="figures/hero_light.jpg" width="920">
</picture>

*Featured result: secret-key rate and QBER vs channel loss (no-attack vs intercept–resend).*
Plots are generated by `./py -m sat_qkd_lab.run sweep` and written to `figures/`.

## Quickstart

Repo-local runners are `./py` and `./pytest`. If present, make them executable and verify they exist before proceeding (fail fast if they are missing).

```bash
git clone https://github.com/christopher-altman/sat-qkd-security-curves
cd sat-qkd-security-curves

[ -f ./py ] && chmod +x ./py
[ -f ./pytest ] && chmod +x ./pytest

test -x ./py || { echo "Missing ./py runner; see repo-local runners section." >&2; exit 1; }
test -x ./pytest || { echo "Missing ./pytest runner; see repo-local runners section." >&2; exit 1; }

PY=python3
$PY -V  # must be >= 3.10
test -x .venv/bin/python || $PY -m venv .venv

./py -m pip install -U pip
./py -m pip install -e ".[dev]"

./py -m sat_qkd_lab.run --help
./pytest -q
```

Quick run examples:

```bash
./py -m sat_qkd_lab.run sweep --loss-min 20 --loss-max 60 --steps 21 --pulses 200000
./py -m sat_qkd_lab.run pass-sweep --max-elevation 70 --pass-duration 300
./py -m sat_qkd_lab.run experiment-run --n-blocks 20 --block-seconds 30 --outdir .
./py -m sat_qkd_lab.run forecast-run --forecasts forecasts.json --outdir .
./py -m sat_qkd_lab.run coincidence-sim --loss-min 20 --loss-max 60 --steps 9 --outdir .
```

## Layout

```
.
├─ src/sat_qkd_lab/
│  ├─ run.py
│  ├─ plotting.py
│  ├─ attacks.py
│  ├─ bb84.py
│  ├─ basis_bias.py
│  ├─ calibration.py
│  ├─ calibration_fit.py
│  ├─ change_points.py
│  ├─ clock_sync.py
│  ├─ coincidence.py
│  ├─ constellation.py
│  ├─ dashboard.py
│  ├─ decoy_bb84.py
│  ├─ detector.py
│  ├─ eb_observables.py
│  ├─ eb_qkd.py
│  ├─ event_stream.py
│  ├─ fading_samples.py
│  ├─ fim_identifiability.py
│  ├─ forecast.py
│  ├─ forecast_harness.py
│  ├─ free_space_link.py
│  ├─ helpers.py
│  ├─ hil_adapters.py
│  ├─ link_budget.py
│  ├─ optical_link.py
│  ├─ optics.py
│  ├─ ou_fading.py
│  ├─ pass_model.py
│  ├─ pointing.py
│  ├─ polarization_drift.py
│  ├─ scoring.py
│  ├─ sweep.py
│  ├─ telemetry.py
│  ├─ timetags.py
│  ├─ timing.py
│  ├─ windows.py
│  └─ __init__.py
├─ tests/
│  ├─ test_forecast_harness.py
│  ├─ test_calibration_fit.py
│  └─ ...
├─ notebooks/
├─ figures/
├─ reports/
└─ results/
```

## Problem

Satellite and fibre Quantum Key Distribution (QKD) systems live or die on a simple fact: bits can still flow while secrecy collapses. This experiment creates a reproducible “security curve” lab: simulate realistic loss/noise, models that security cliff and makes it visible before it becomes a system risk.

## Thesis

Security curves are only trustworthy if they respect instrument constraints. This lab ties link budgets, detector effects, and protocol thresholds into a single engineering picture and acts as a link‑budget → security‑budget translator for engineering decisions.

## Physics/Math Background

Transmittance `η` is the probability a photon survives the channel and reaches the receiver.  
QBER `e` is the bit error rate after sifting, so it captures the net disturbance of the link.  
Binary entropy `h(e)` expresses uncertainty per bit (0 to 1), and it rises quickly with noise.  
For BB84, the asymptotic secret fraction decreases as `e` grows and vanishes as `e → 0.5`.  
That’s the security cliff: detections and sifted bits can remain nonzero while secrecy collapses.  

Realism primitives (units explicit): timing jitter σ is typically 10–200 ps for SPDs and stored in seconds in code/JSON; coincidence window τc is sub‑ns and stored in seconds; fading variance Var(T) captures heavy‑tailed, time‑correlated free‑space optics where rare deep fades dominate.  

## Approach

- Abort headroom is `qber_abort − qber_mean`, the distance to the protocol’s error threshold, with headroom treated as absolute QBER (e.g., 0.05 means a 5% margin to an 11% abort threshold).  
- CAR (coincidence‑to‑accidental ratio) is a signal‑quality witness in entanglement‑based QKD.  
- Elevation profiles map to time‑varying loss and background during pass sweeps.  
- Finite‑key penalties cap what can be claimed with limited samples, even when averages look good.  
- Expected‑value sweeps, pass‑sweep time series, and the experiment/forecast harnesses are tied together under a single operational discipline.  
- Topics: qml, quantum-ml, verification, cryptography, robustness, quantum-cryptography, qkd, bb84, satellite, security, noise-analysis, infosec, network-security, simulation.  

## Capabilities

- Field names and filenames shown below are taken from current `reports/` outputs; if you change schema or filenames, update this section in the same commit.
- **Sync protocol:** `./py -m sat_qkd_lab.run sync-estimate` generates `reports/latest_sync_params.json` (Planned if not present in this checkout). `--sync-params <path>` is accepted by `experiment-run`, `forecast-run`, and `coincidence-sim`. Inline sync is blocked unless `--allow-inline-sync` (or `--allow-resync`) is set. Coincidence reports include `sync.locked`, `sync.source`/`sync.method`, `sync.offset_s` (seconds), `sync.drift_ppm`, and `sync.inline_sync_used`.
- **Pass realism:** enable `pass-sweep --fading-ou` with `--fading-ou-mean`, `--fading-ou-sigma`, `--fading-ou-tau-s`. Summary includes `summary.fading.mean`, `summary.fading.var`, `summary.fading.corr_time_seconds`, and `summary.outages` with `count`, `mean_duration_s`, and `durations_s`. Plots are generated on run (Planned if not present in this checkout): `figures/fading_ou_time.png`, `figures/secure_window_fragmentation.png`.
- **Polarization / basis bias:** enable `pass-sweep --pol-rotation --pol-rotation-max-deg --basis-bias-max`. Outputs include `pol.rotation_angle_deg`, `basis.bias_mean`, `basis.bias_std`, and time‑series `pol_rotation_deg`/`basis_bias`. Plot generated on run (Planned if not present in this checkout): `figures/pol_rotation_vs_elevation.png`.
- **Calibration card:** `calibration-fit` writes `reports/latest_calibration_card.json` (Planned if not present in this checkout) with `model_card.fit.r2`, `model_card.fit.param_uncertainty`, `model_card.fim.cond`, `model_card.fim.identifiable`, and `model_card.identifiable`. Warnings are emitted when identifiability is low. Plots generated on run (Planned if not present in this checkout): `figures/calibration_quality_card.png`, `figures/calibration_residuals.png`.
- **Blinding + JSON contract:** append‑only JSON keys, required units (Hz, seconds, bits, bps, degrees where used), and no label leakage unless `--unblind`. Tests cover `reports/latest.json`, `reports/latest_pass.json`, `reports/latest_experiment.json`, `reports/forecast_blinded.json` (Planned if not present), and `reports/latest_sync_params.json` (Planned if not present).
- **Dashboard:** install with `./py -m pip install -e ".[dashboard]"` and launch via `./py -m sat_qkd_lab.dashboard` (blinded by default).
- **Outputs (selected, present in this checkout):** `reports/latest.json`, `reports/latest_pass.json`, `reports/latest_experiment.json`, `reports/latest_coincidence.json`, `reports/schedule_blinded.json`; figures include `figures/key_qber_vs_loss.png`, `figures/key_fraction_vs_loss.png`, `figures/qber_vs_loss_ci.png`, `figures/secret_fraction_vs_loss_ci.png`, `figures/qber_headroom_vs_loss.png`, `figures/key_rate_vs_elevation.png`, `figures/secure_window_per_pass.png`, `figures/loss_vs_elevation.png`, `figures/car_vs_loss.png`, `figures/chsh_s_vs_loss.png`, `figures/visibility_vs_loss.png`.
- **JSON outputs (schema + stability):** outputs are append‑only, require explicit units where applicable, and blinded outputs contain no labels unless `--unblind`.
  ```json
  {
    "schema_version": "0.4",
    "generated_utc": "YYYY-MM-DDTHH:MM:SSZ",
    "pass_sweep": { "summary": { "qber_abort": 0.11 } },
    "parameters": { "rep_rate": 1e8 }
  }
  ```
- **CI bounds:** CI lower bounds are clamped to 0; QBER CI upper bounds are clamped to 0.5.  
- Artifacts & provenance: each development prompt writes `docs/report-P{N}-...` and `docs/diff-P{N}-...` with a verbatim `ls -l docs` gating proof.

## Why it matters

Operators need to see where secrecy collapses long before it fails in the field. Loss alone reduces detections, but secrecy fails when error rates dominate; intercept–resend drives the secret fraction to zero even when sifted bits remain. The curves show an engineering‑facing security budget: physics‑level behavior (loss/noise/attack) translates into operational metrics (QBER, secret‑key rate), which are imperative in integrated satellite + fiber QKD networks. This repo makes the cliff explicit and measurable.

## Topics

`qml` · `quantum-ml` · `verification` · `cryptography` · `robustness` · `quantum-cryptography` · `qkd` · `bb84` · `satellite` · `security` · `noise-analysis` · `infosec` · `network-security` · `simulation`

## References

1. Bennett, C. H., & Brassard, G. (1984). [Quantum cryptography: Public key distribution and coin tossing.](https://www.sciencedirect.com/science/article/pii/S0304397514004241) *Proceedings of the IEEE International Conference on Computers, Systems and Signal Processing* (Bangalore, India), 175–179.

2. Ekert, A. K. (1991). [Quantum cryptography based on Bell’s theorem.](https://doi.org/10.1103/PhysRevLett.67.661) *Physical Review Letters*, *67*(6), 661–663. 

3. Shor, P. W., & Preskill, J. (2000). [Simple proof of security of the BB84 quantum key distribution protocol.](https://doi.org/10.1103/PhysRevLett.85.441) *Physical Review Letters*, *85*, 441–444. 

4. Renner, R., Gisin, N., & Kraus, B. (2005). [An information-theoretic security proof for QKD protocols.](http://arXiv:quant-ph/0502064) *[Physical Review A](https://doi.org/10.1103/PhysRevA.72.012332)*, *72*, 012332.  

5. Gisin, N., Ribordy, G., Tittel, W., & Zbinden, H. (2002). [Quantum cryptography.](https://doi.org/10.1103/RevModPhys.74.145) *Reviews of Modern Physics*, *74*(1), 145–195. 

6. Altman, C., Williams, C., Ursin, R., Villoresi, P., Sharma, V. [Astronaut Development and Deployment of a Secure Space Communications Network.](https://drive.google.com/file/d/0B99KWApna6GoX3JzZGMzbzNrMjg/view?resourcekey=0-b1lf7VUq8QmpRriVN5N2sw) NASA NIAC/OCT; DARPA QUINESS (Macroscopic Quantum Communications). 

## Citations

If you use QVL in your research, please cite:

```bibtex
@software{sat-qkd-curves2026,
  title={Satellite Quantum Key Distribution Security Curves},
  author={Altman, Christopher},
  year={2026},
  url={https://github.com/christopher-altman/sat-qkd-security-curves}
}
```

## License

MIT License. See [LICENSE](LICENSE) for details.

## Contact

- **Website:** [christopheraltman.com](https://christopheraltman.com)
- **Research portfolio:** [lab.christopheraltman.com](https://lab.christopheraltman.com/)
- **Portfolio mirror:** [christopher-altman.github.io](https://christopher-altman.github.io/)
- **GitHub:** [github.com/christopher-altman](https://github.com/christopher-altman)
- **Google Scholar:** [scholar.google.com/citations?user=tvwpCcgAAAAJ](https://scholar.google.com/citations?user=tvwpCcgAAAAJ)
- **Email:** x@christopheraltman.com

---

*Christopher Altman (2026)*